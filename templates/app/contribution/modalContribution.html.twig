{% form_theme form "form/bootstrap_4_horizontal.html.twig" %}

{% set contribution = form.vars.value %}

<div id="modal-contribution" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="modalContributionLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="mb-0">Paiement</h2>
                {% if contribution.id %}

                    {% set theme_color = "dark" %}
                    {% if app.session.get("themeColor") %}{% set theme_color = app.session.get("themeColor") %}{% endif %}
                    
                    <div class="small text-secondary">
                        <p class="mb-0 ml-3 text-right">Créé le {{contribution.createdAt|date("d/m/Y à H:i") }}{% if contribution.createdBy %} par {{ contribution.createdBy.fullname}}{% endif %}<br/>
                            <span id="js-updatedSupport">(modifié le {{ contribution.updatedAt|date("d/m/Y à H:i") }} par {{ contribution.updatedBy.fullname }})</span>
                        </p>
                    </div>
                {% endif %}
            </div>

            {{ form_start(form) }}

            <div class="modal-body form-group pb-0">
                <div class="row">
                    <div class="col-lg-6">{{ form_row(form.type) }}</div>
                    <div class="col-lg-6 js-contribution d-none">
                        <div class="form-group row">
                            {{ form_label(form.periodContribution) }}
                            <div class="col-4">{{ form_widget(form.periodContribution.month) }}</div>
                            <div class="col-4">{{ form_widget(form.periodContribution.year) }}</div>
                            <div class="d-none">{{ form_widget(form.periodContribution.day) }}</div>
                        </div>
                    </div>
                </div>
                <hr class="mt-0">
                <div class="js-contribution d-none">
                    <div class="row">
                        <div class="col-lg-4">{{ form_row(form.resourcesAmt) }}</div>
                        <div class="col-lg-4">{{ form_row(form.salaryAmt) }}</div>
                    </div>
                    <div class="row js-rent d-none">
                        <div class="col-lg-4">{{ form_row(form.rentAmt) }}</div>
                        <div class="col-lg-4">{{ form_row(form.housingAssitanceAmt) }}</div>
                    </div>
                </div>
                <div class="row js-toPayAmt d-none">
                    <div class="col-lg-4">{{ form_row(form.toPayAmt) }}</div>
                    <div class="col-lg-8">
                        <span id="calculationMethod" class="small text-secondary"></span>
                    </div>
                </div>
                <div class="row js-payment d-none">
                    <div class="col-lg-4">{{ form_row(form.paidAmt) }}</div>
                    <div class="col-lg-4">{{ form_row(form.paymentDate) }}</div>
                    <div class="col-lg-4">{{ form_row(form.paymentType) }}</div>
                </div>
                <div class="row js-payment d-none">
                    <div class="col-lg-4">{{ form_row(form.stillToPayAmt) }}</div>
                </div>
                <div class="row js-caution d-none">
                    <div class="col-lg-4">{{ form_row(form.returnAmt) }}</div>
                    <div class="col-lg-4">{{ form_row(form.returnDate) }}</div>
                </div>
                <div class="row js-comment d-none">
                    <div class="col-lg-12">{{ form_widget(form.comment) }}</div>
                </div>
            </div>

            <div class="modal-footer d-flex justify-content-between">
              <div class="float-left">
                    <button id="modal-btn-delete" class="mr-3 btn btn-danger d-block" data-placement="bottom"
                        title="Supprimer"><span class="fas fa-trash-alt"></span><span
                        class="sr-only">Supprimer</span></button>
                </div>
                <div class="float-right">
                    <button type="button" id="js-btn-cancel" class="btn btn-secondary" data-dismiss="modal">Annuler</button>
                    <button type="submit" id="js-btn-save" class="btn btn-{{ theme_color }}">Enregistrer</button>
                </div>
            </div>
            
            {{ form_row(form._token) }}
            {{ form_end(form, {"render_rest": false}) }}

        </div>
    </div>
</div>