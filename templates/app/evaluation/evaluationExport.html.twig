{% import "macros/viewParagraph.html.twig" as pElt %}
{% import "macros/ViewLi.html.twig" as liElt %}

{% set nbSupportPeople = support.supportPeople|length %}
{% set ROLE_CHILD = constant("App\\Entity\\RolePerson::ROLE_CHILD") %}
{% set YES = constant("App\\Form\\Utils\\Choices::YES") %}
{% set NO = constant("App\\Form\\Utils\\Choices::NO") %}
{% set IN_PROGRESS = constant("App\\Form\\Utils\\Choices::IN_PROGRESS") %}

{% apply spaceless %}

    {% for supportPerson in support.supportPeople|filter(s => s.head == true) %}
        {{ pElt.get(supportPerson.person.lastname, "Nom du ménage") }}
        {{ pElt.get(supportPerson.person.phone1, "Phone") }}
        {{ pElt.get(supportPerson.person.email, "Email") }}
    {% endfor %}

    {{ pElt.get(support.city or support.address ? support.address ~ ", " ~ support.zipcode ~ " " ~ support.city : "", "Address") }}

    <br/>

    {{ pElt.get(support.groupPeople.familyTypologyToString~ (nbSupportPeople > 1 ? 
        ", " ~ nbSupportPeople ~ " personnes"), "Family typology") }}

    <table class="table-bordered mb-2">
        <thead>
            <tr style="font-weight: bold;">
                <th>Nom et prénom</th>
                <th>Date de naissance</th>
                <th>Âge</th>
                <th>Sexe</th>
                <th>Rôle</th>
                {# <th>Téléphone</th>
                <th>Adresse email</th> #}
            </tr>
        </thead>
        <tbody>
            {% for supportPerson in support.supportPeople %}
            <tr>
                <td scope="row">{{ supportPerson.person.fullname }}</td>
                <td style="text-align: center;">{{ supportPerson.person.birthdate|date("d/m/Y") }}</td>
                <td>{{ supportPerson.person.age }} an{{ supportPerson.person.age > 1 ? "s" }}</td>
                <td>{{ supportPerson.person.genderToString }}</td>
                <td>{{ supportPerson.roleToString }}</td>
                {# <td>{{ supportPerson.person.phone1 }}</td>
                <td>{{ supportPerson.person.email }}</td> #}
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <br/>

    {{ pElt.get(lastRdv ? lastRdv.start|date("d/m/Y à H:i"), "rdv.last") }}
    {{ pElt.get(nextRdv ? nextRdv.start|date("d/m/Y à H:i"), "rdv.next") }}

    {% set evalHousing = evaluation.evalHousingGroup %}

    <br/>

    {% set style_h3 = "font-size: 21.5px; font-weight: bold;" %}
    {% set style_h4 = "font-size: 16px; font-weight: bold;" %}

    {# Justice #}
    {% if support.service.justice == YES %}
        <h3 class="h4" style="{{ style_h3 }}">Situation judiciaire</h3>
        {% for evalPerson in evaluation.evaluationPeople %}
            {% set evalJustice = evalPerson.evalJusticePerson %}
            {% if evalJustice %}
                {% if nbSupportPeople > 1 %}
                    <p style="{{ style_h4 }}"><u>{{ evalPerson.supportPerson.person.fullname }}</u> :</p>
                {% endif %}
                {{ pElt.get(evalJustice.justiceStatusToString, "Justice status", "evaluation") }}
                {{ pElt.get(evalJustice.justiceActToString, "Justice act", "evaluation") }}
                 <div style="text-align: justify;">{{ pElt.get(evalJustice.commentEvalJustice) }}</div>
            {% endif %}
        {% endfor %}
    {% endif %}

    <h3 class="h4" style="{{ style_h3 }}">Situation sociale</h3>
    {% for evalPerson in evaluation.evaluationPeople %}
        {% set evalSocial = evalPerson.evalSocialPerson %}
        {% if evalSocial and (evalSocial.rightSocialSecurity or evalSocial.healthProblem == YES)  %}
            {% if nbSupportPeople > 1 %}
                <p style="{{ style_h4 }}"><u>{{ evalPerson.supportPerson.person.fullname }}</u> :</p>
            {% endif %}
            {{ pElt.get(evalSocial.rightSocialSecurity in [1, 3] ? evalSocial.rightSocialSecurityToString ~ " - " 
                ~ evalSocial.socialSecurityToString : evalSocial.rightSocialSecurityToString, "Right social security", "evaluation") }}
            {{ pElt.get(evalSocial.socialSecurityOffice, "Social security office", "evaluation") }}
            {{ pElt.get(evalSocial.childWelfareBackground == YES ? evalSocial.childWelfareBackgroundToString, "Child welfare background", "evaluation") }}
            {% if evalSocial.familyBreakdown == YES or evalSocial.friendshipBreakdown == YES %}
                {{ pElt.get(evalSocial.familyBreakdownToString, "Family breakdown", "evaluation") }}
                {{ pElt.get(evalSocial.friendshipBreakdownToString, "Friendship breakdown", "evaluation") }}
            {% endif %}
            {% if evalSocial.healthProblem == YES %}
                {{ pElt.get(evalSocial.healthProblemToString, "Health problem", "evaluation") }}
                <ul>
                    {% for key, value in evalSocial.healthProblemsType %}
                        {% if attribute(evalSocial, key) %}
                            <li>{{ value }}</li>
                        {% endif %}
                    {% endfor %}									 
                </ul>
            {% endif %}
            {{ pElt.get(evalSocial.careSupport == YES ? evalSocial.careSupportToString ~ (evalSocial.careSupportType ? " - " 
                ~ evalSocial.careSupportTypeToString : ""), "Care support", "evaluation") }}
            {{ pElt.get(evalSocial.violenceVictim == YES ? evalSocial.violenceVictimToString ~ (evalSocial.domViolenceVictim == YES ? 
                " (Violence conjugale)" : ""), "Violence victim", "evaluation") }}
            <div style="text-align: justify;">{{ pElt.get(evalSocial.commentEvalSocialPerson) }}</div>
        {% endif %}
    {% endfor %}

    {% if evaluation.evalSocialGroup %}
        {% set evalSocial = evaluation.evalSocialGroup %}
            {# {{ pElt.get(evalSocial.reasonRequestToString, "Reason request", "evaluation") }} #}
            {# {{ pElt.get(evalSocial.wanderingTimeToString, "Wandering time", "evaluation") }} #}
            {{ pElt.get(evalSocial.animal == YES ? evalSocial.animalToString ~ (evalSocial.animalType ? " (" ~ evalSocial.animalType ~ ")" : "" ), "Animal", "evaluation") }}
        <div style="text-align: justify;">{{ pElt.get(evaluation.evalSocialGroup.commentEvalSocialGroup) }}</div>
    {% endif %}

    <br/>

    <h3 class="h4" style="{{ style_h3 }}">Situation familiale</h3>
    {% for evalPerson in evaluation.evaluationPeople|filter(e => e.supportPerson.role != ROLE_CHILD) %}
        {% set evalFamily = evalPerson.evalFamilyPerson %}
        {% if nbSupportPeople > 1 %}
            <p style="{{ style_h4 }}"><u>{{ evalPerson.supportPerson.person.fullname }}</u> :</p>
        {% endif %}       
        {{ pElt.get(evalFamily.maritalStatusToString, "Marital status", "evaluation") }}
        {{ pElt.get(evalFamily.protectiveMeasure == YES and evalFamily.protectiveMeasureType ? 
            evalFamily.protectiveMeasureTypeToString : "", "Protective measure", "evaluation") }}
        {{ pElt.get(evalFamily.unbornChild == YES ? evalFamily.unbornChildToString ~ (evalFamily.expDateChildbirth ? " (" 
            ~ evalFamily.expDateChildbirth|date("d/m/Y") ~ ")" : "") : "", "Unborn child", "evaluation") }}
        <div style="text-align: justify;">{{ pElt.get(evalFamily.commentEvalFamilyPerson) }}</div>
    {% endfor %}

    {% if support.groupPeople.familyTypology in [4, 5, 6, 8] %} {# si typologie familiale avec enfants #}
        <table class="table-bordered">
            <thead>
                <tr style="font-weight: bold;">
                    <th scope="col">Enfant(s)</th>
                    <th>Garde ou scolarité</th>
                    <th>Lieu de garde/scolarité</th>
                    <th>Hébergement</th>
                    <th>À charge</th>
                </tr>
            </thead>
            <tbody>
                {% for evalPerson in evaluation.evaluationPeople|filter(e => e.supportPerson.role == ROLE_CHILD) %}
                    {% set evalFamilyPerson = evalPerson.evalFamilyPerson %}
                    <tr>
                        <td scope="row">{{ evalPerson.supportPerson.person.fullname }}</td>
                        <td>{{ evalFamilyPerson.childcareSchoolToString }}</td>
                        <td>{{ evalFamilyPerson.childcareSchoolLocation }}</td>
                        <td>{{ evalFamilyPerson.childToHostToString }}</td>
                        <td>{{ evalFamilyPerson.childDependanceToString }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}

    {% set evalFamily = evaluation.evalFamilyGroup %}
    {% if evalFamily %}
        {# {{ pElt.get(evalFamily.cafId, "Caf id", "evaluation") }} #}
        {{ pElt.get(evalFamily.nbDependentChildren, "Nb dependent children", "evaluation") }}
        {{ pElt.get(evalFamily.famlReunification == YES ? evalFamily.famlReunificationToString ~ (evalFamily.nbPeopleReunification ? " (" 
            ~ evalFamily.nbPeopleReunification ~ " personne(s))" : "") : "", "Faml reunification", "evaluation") }}
        <div style="text-align: justify;">{{ pElt.get(evaluation.evalFamilyGroup.commentEvalFamilyGroup) }}</div>
    {% endif %}

    <br/>

    <h3 class="h4" style="{{ style_h3 }}">Situation administrative</h3>

    {% for evalPerson in evaluation.evaluationPeople|filter(e => e.supportPerson.role != ROLE_CHILD) %}
        {% set evalAdm = evalPerson.evalAdmPerson %}
        {% if nbSupportPeople > 1 %}
            <p style="{{ style_h4 }}"><u>{{ evalPerson.supportPerson.person.fullname }}</u> :</p>
        {% endif %}
        {{ pElt.get(evalAdm.nationality ? evalAdm.nationalityToString ~ (evalAdm.country ? ' (' 
            ~ evalAdm.country ~ ')' : "") : "", "Nationality", "evaluation") }}
        {{ pElt.get(evalAdm.arrivalDate ? evalAdm.arrivalDate|date("d/m/Y"), "Arrival date", "evaluation") }}
        {{ pElt.get(evalAdm.paper == YES and evalAdm.paperType ? evalAdm.paperTypeToString : evalAdm.paperToString, "Paper", "evaluation") }}
        {{ pElt.get(evalAdm.asylumBackground == YES and evalAdm.asylumStatus ? evalAdm.asylumStatusToString, "Asylum background", "evaluation") }}
        {{ pElt.get(evalAdm.renewalPermitDate ? evalAdm.renewalPermitDate|date("d/m/Y") 
            ~ (evalAdm.nbRenewals ? " (" ~ evalAdm.nbRenewals ~ " renouvellement(s))") : "", "Renewal permit date"  ) }}
        {{ pElt.get(evalAdm.endValidPermitDate ? evalAdm.endValidPermitDate|date("d/m/Y") : "", "End valid permit date", "evaluation") }}
        {{ pElt.get(evalAdm.workRightToString, "Work right", "evaluation") }}
        <div style="text-align: justify;">{{ pElt.get(evalAdm.commentEvalAdmPerson) }}</div>
    {% endfor %}

    {# {% if support.groupPeople.familyTypology in [4, 5, 6, 8] %}
        <table class="table-bordered">
            <thead>
                <tr style="font-weight: bold;">
                    <th scope="col">Enfants</th>
                    <th>Nationalité</th>
                    <th>Papier</th>
                </tr>
            </thead>
            <tbody>
                    {% for evalPerson in evaluation.evaluationPeople|filter(e => e.supportPerson.role == ROLE_CHILD %}
                        {% set evalAdm = evalPerson.evalAdmPerson %}
                        <tr>
                            <td scope="row">{{ evalPerson.supportPerson.person.fullname }}</td>
                            <td>{{ evalAdm.nationalityToString }}</td>
                            <td>{{ evalAdm.paperType ? evalAdm.paperTypeToString : evalAdm.paperToString }}</td>
                        </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %} #}

    <br/>

    <h3 class="h4" style="{{ style_h3 }}">Situation professionnelle</h3>

    {% for evalPerson in evaluation.evaluationPeople|filter(e => e.supportPerson.role != ROLE_CHILD) %}
        {% set evalProf = evalPerson.evalProfPerson %}
        {% if evalProf %}
            {% if nbSupportPeople > 1 %}
                <p style="{{ style_h4 }}"><u>{{ evalPerson.supportPerson.person.fullname }}</u> :</p>
            {% endif %}                
            {{ pElt.get(evalProf.schoolLevelToString, "School level", "evaluation") }}
            {{ pElt.get(evalProf.profExperienceToString, "Prof experience", "evaluation") }}
            {{ pElt.get(evalProf.profStatus ? evalProf.profStatusToString ~ (evalProf.contractType ? " (" 
                ~ evalProf.contractTypeToString ~ ")" : "") : "", "Prof status", "evaluation") }}
            {{ pElt.get(evalProf.jobCenterId, "Job center id", "evaluation") }}
            {{ pElt.get(evalProf.jobType, "Job type", "evaluation") }}
            {{ pElt.get(evalProf.contractEndDate ? evalProf.contractEndDate|date("d/m/Y"), "Contract end date", "evaluation") }}
            {{ pElt.get(evalProf.workingHours ? evalProf.workingHours ~ (evalProf.nbWorkingHours ? " (nb d'heures : " 
                ~ evalProf.nbWorkingHours ~ ")" : "") : "", "Working hours", "evaluation") }}
            {{ pElt.get(evalProf.employerName ? evalProf.employerName ~ (evalProf.workPlace ? " | " 
                ~ evalProf.workPlace : "") : "", "Employer name", "evaluation") }}
            {{ pElt.get(evalProf.transportMeansType ? evalProf.transportMeansTypeToString ~ (evalProf.transportMeans ? " (" 
                ~ evalProf.transportMeans ~ ")" : ""): "", "Transport means type", "evaluation") }}
            {{ pElt.get(evalProf.rqth in [YES, IN_PROGRESS]  ? evalProf.rqthToString ~ (evalProf.endRqthDate ? " (fin de validité : " 
                ~ evalProf.endRqthDate|date("d/m/Y") ~ ")" : ""): "", "Rqth", "evaluation") }}
            <div style="text-align: justify;">{{ pElt.get(evalProf.commentEvalProf) }}</div>
        {% endif %}
    {% endfor %}

    {% set evalBudgetGroup = evaluation.evalBudgetGroup %}
    {% if evalBudgetGroup %}

    <br/>

    <h3 class="h4" style="{{ style_h3 }}">Situation budgétaire</h3>
    <ul>
        {{ liElt.get(evalBudgetGroup.resourcesGroupAmt|number_format(0, ",", " ") ~ " €", "Resources", "evaluation" ) }}
        {{ liElt.get(evalBudgetGroup.chargesGroupAmt|number_format(0, ",", " ") ~ " €", "Charges", "evaluation" ) }}
        {{ liElt.get(evalBudgetGroup.monthlyRepaymentAmt|number_format(0, ",", " ") ~ " €", "Monthly repayment amt", "evaluation" ) }}
        {{ liElt.get(evalBudgetGroup.budgetBalanceAmt|number_format(0, ",", " ") ~ " €", "Budget balance amt", "evaluation" ) }}
        {{ liElt.get(evalBudgetGroup.debtsGroupAmt|number_format(0, ",", " ") ~ " €", "Debts group amt", "evaluation" ) }}
    </ul>

    {% for evalPerson in evaluation.evaluationPeople|filter(e => e.supportPerson.role != ROLE_CHILD) %}
        {% set evalBudget = evalPerson.evalBudgetPerson %}
        {% if evalBudget %}	
            {% if nbSupportPeople > 1 %}
                <p style="{{ style_h4 }}"><u>{{ evalPerson.supportPerson.person.fullname }}</u> :</p>
            {% endif %}            
            
            {{ pElt.get(evalBudget.resourcesToString, "Resources", "evaluation") }}
                <ul>
                    {% for key, value in evalBudget.resourcesType %}
                        {% if attribute(evalBudget, key) %}
                            {% set amt = attribute(evalBudget, key ~ 'Amt')|number_format(0, ",", " ") %}
                            <li>{{ loop.last ? attribute(evalBudget, key ~ 'Precision') : value }}{{ amt > 0 ? ' : ' ~ amt ~ ' €' }}</li>
                        {% endif %}
                    {% endfor %}
                    {{ liElt.get(evalBudget.resourcesAmt > 0 ? evalBudget.resourcesAmt|number_format(0, ",", " ") ~ " €", "Total des ressources") }}
                </ul>
                {{ pElt.get(evalBudget.incomeN1Amt > 0 ? evalBudget.incomeN1Amt|number_format(0, ",", " ") ~ " €", "Impôts sur le revenu n-1") }}
                {{ pElt.get(evalBudget.incomeN2Amt > 0 ? evalBudget.incomeN2Amt|number_format(0, ",", " ") ~ " €", "Impôts sur le revenu n-2") }}
                {{ pElt.get(evalBudget.resourcesComment, "Resources comment", "evaluation") }}

            {{ pElt.get(evalBudget.chargesToString, "Charges", "evaluation") }}
            <ul>
                {% for key, value in evalBudget.chargesType %}
                    {% if attribute(evalBudget, key) %}
                        {% set amt = attribute(evalBudget, key ~ 'Amt')|number_format(0, ",", " ") %}
                        <li>{{ loop.last ? attribute(evalBudget, key ~ 'Precision') : value }}{{ amt > 0 ? ' : ' ~ amt ~ ' €' }}</li>
                    {% endif %}
                {% endfor %}
                {{ liElt.get(evalBudget.chargesAmt > 0 ? evalBudget.chargesAmt|number_format(0, ",", " ") ~ " €", "Total des charges") }}
            </ul>
                {{ pElt.get(evalBudget.chargeComment, "Charge comment", "evaluation") }}

            {% if evalBudget.debts %}
                {{ pElt.get(evalBudget.debtsToString, "Debts", "evaluation") }}
                {% if evalBudget.debts == YES %}
                    <ul>
                        {% for key, value in evalBudget.debtsType %}
                            {% if attribute(evalBudget, key) %}
                                <li>{{ value }}</li>
                            {% endif %}
                        {% endfor %}
                    </ul>
                {% endif %}
                {{ pElt.get(evalBudget.debtComment, "Debt comment", "evaluation") }}
                {{ pElt.get(evalBudget.overIndebtRecord ? evalBudget.overIndebtRecordToString ~ (evalBudget.overIndebtRecordDate ? 
                    " (date de dépôt : " ~ evalBudget.overIndebtRecordDate|date("d/m/Y") ~ ")" : "") : "", "Over indebt record", "evaluation") }}
                {{ pElt.get(evalBudget.settlementPlanToString, "Settlement plan", "evaluation") }}
                {{ pElt.get(evalBudget.moratoriumToString, "Moratorium", "evaluation") }}
                {{ pElt.get(evalBudget.endRightsDate ? evalBudget.endRightsDate|date("d/m/Y") : "", "End rights date", "evaluation") }}
            {% endif %}
            <div style="text-align: justify;">{{ pElt.get(evalBudget.commentEvalBudget) }}</div>
        {% endif %}

    {% endfor %}

    {% endif %}

    {% set evalHousing = evaluation.evalHousingGroup %}
    {% if evalHousing %}
        <br/>
        <h3 class="h4" style="{{ style_h3 }}">Situation au regard du logement</h3>
        {{ pElt.get(evalHousing.housingStatusToString, "Housing status", "evaluation") }}
        {% if evalHousing.siaoRequest %}
            {{ pElt.get(evalHousing.siaoRequestToString, "Siao request", "evaluation") }}
            <ul>
                {{ liElt.get(evalHousing.siaoRequestDate ? evalHousing.siaoRequestDate|date("d/m/Y") 
                    ~ (evalHousing.siaoUpdatedRequestDate ? " (actualisation : " ~ evalHousing.siaoUpdatedRequestDate|date("d/m/Y") 
                    ~ ")" : "") : "", "Siao request date", "evaluation") }}
                {{ liElt.get(evalHousing.siaoRequestDept, "Siao request dept", "evaluation") }}
                {{ liElt.get(evalHousing.siaoRecommendationToString, "Siao recommendation", "evaluation") }}
            </ul>
        {% endif %}
        {% if evalHousing.socialHousingRequest %}
            {{ pElt.get(evalHousing.socialHousingRequestToString ~ (evalHousing.socialHousingRequestId ? " (NUR : " 
                ~ evalHousing.socialHousingRequestId ~ ")" : ""), "Social housing request", "evaluation") }}
            <ul>
                {{ liElt.get(evalHousing.socialHousingRequestDate ? evalHousing.socialHousingRequestDate|date("d/m/Y") 
                    ~ (evalHousing.socialHousingUpdatedRequestDate ? " (actualisation : " ~ evalHousing.socialHousingUpdatedRequestDate|date("d/m/Y") 
                    ~ ")" : "") : "", "Date demande de logement social", "evaluation") }}
                {{ liElt.get(evalHousing.housingWishes, "Housing wishes", "evaluation") }}
                {{ liElt.get(evalHousing.citiesWishes, "Cities wishes", "evaluation") }}
                {{ liElt.get(evalHousing.specificities, "Specificities", "evaluation") }}
            </ul>
        {% endif %}
        {% if evalHousing.syplo in [YES, IN_PROGRESS] %}
            {{ pElt.get(evalHousing.syploToString, "Syplo", "evaluation") }}
            <ul>
                {{ liElt.get(evalHousing.syploDate ? evalHousing.syploDate|date("d/m/Y"), "Syplo date", "evaluation") }}
                {{ liElt.get(evalHousing.syploId, "Syplo id", "evaluation") }}
            </ul>
        {% endif %}
        {% if evalHousing.daloCommission in [YES, IN_PROGRESS] %}
            {{ pElt.get(evalHousing.daloCommissionToString ~ (evalHousing.daloRequalifiedDaho == YES ? " - Requalifié DAHO" ), "Dalo commission", "evaluation") }}
            <ul>
                {{ liElt.get(evalHousing.daloDecisionDate ? evalHousing.daloDecisionDate|date("d/m/Y"), "Dalo decision date", "evaluation") }}
                {{ liElt.get(evalHousing.daloId, "Dalo id", "evaluation") }}
                {{ liElt.get(evalHousing.daloRecordDate ? evalHousing.daloRecordDate|date("d/m/Y"), "Dalo record date", "evaluation") }}
                {{ liElt.get(evalHousing.daloTribunalAction in [YES, IN_PROGRESS] ? evalHousing.daloTribunalActionToString ~ (evalHousing.daloTribunalActionDate ? 
                    " (le " ~ evalHousing.daloTribunalActionDate|date("d/m/Y") ~ ")"), "Dalo tribunal action", "evaluation") }}
            </ul>
        {% endif %}
        {# {% if evalHousing.collectiveAgreementHousing %}
            {{ pElt.get(evalHousing.collectiveAgreementHousingToString ~ (evalHousing.collectiveAgreementHousingDate ? 
                " (le " ~ evalHousing.collectiveAgreementHousingDate|date("d/m/Y") ~ ")"), "Collective agreement housing", "evaluation") }}
        {% endif %} #}
        {% if evalHousing.hsgActionEligibility == YES %}					
            {{ pElt.get(evalHousing.hsgActionEligibilityToString, "Hsg action eligibility", "evaluation") }}
            {{ pElt.get(evalHousing.hsgActionRecordToString ~ (evalHousing.hsgActionDate ? 
                " (le " ~ evalHousing.hsgActionDate|date("d/m/Y") ~ ")"), "Hsg action record", "evaluation") }}
            {{ pElt.get(evalHousing.hsgActionRecordId, "Hsg action record id", "evaluation") }}
            {{ pElt.get(evalHousing.hsgActionDept, "Hsg action dept", "evaluation") }}
        {% endif %}
        {% if evalHousing.expulsionInProgress == YES %}
            {{ pElt.get(evalHousing.expulsionInProgressToString, "Expulsion in progress", "evaluation") }}
            {{ pElt.get(evalHousing.publicForceToString ~ (evalHousing.publicForceDate ? 
                " (le " ~ evalHousing.publicForceDate|date("d/m/Y") ~ ")"), "Public force", "evaluation") }}
            {{ pElt.get(evalHousing.expulsionComment) }}
        {% endif %}
        {# {% if evalHousing.housingExperience %} #}
            {{ pElt.get(evalHousing.housingExperienceToString, "Housing experience", "evaluation") }}
            {# {{ pElt.get(evalHousing.housingExpeComment) }}
        {% endif %} #}
        {# <ul>
            {% for key, value in evalHousing.housingHelps %}
                {% if attribute(evalHousing, key) %}
                    <li>{{ value }}</li>
                {% endif %}
            {% endfor %}
        </ul> #}
        {{ pElt.get(evalHousing.domiciliation == YES ? evalHousing.domiciliationAddress ~ (evalHousing.domiciliationCity ? " - " 
                ~ evalHousing.domiciliationDept ~ " " ~ evalHousing.domiciliationCity : "") : "", "Domiciliation", "evaluation") }}
        <div style="text-align: justify;">{{ pElt.get(evalHousing.commentEvalHousing) }}</div>
                
    {% endif %}

    {# Vie à l'hôtel #}
    {% set evalHotelLife = evaluation.evalHotelLifeGroup %}
    {% if evalHotelLife %}
        <br/>
        <h3 class="h4" style="{{ style_h3 }}">Vie à l'hôtel</h3>
        <div style="text-align: justify;">
            {{ pElt.get(evalHotelLife.food, "Food", "evaluation") }}
            {{ pElt.get(evalHotelLife.clothing, "Clothing", "evaluation") }}
            {{ pElt.get(evalHotelLife.roomMaintenance, "Room maintenance", "evaluation") }}
            {{ pElt.get(evalHotelLife.otherHotelLife, "Other hotel life", "evaluation") }}
            {{ pElt.get(evalHotelLife.commentHotelLife, "Comment hotel life", "evaluation") }}
        </div>
    {% endif %}

    {# Parcours de vie #}
    {% if evaluation.backgroundPeople %}
        <br/>
        <h3 class="h4" style="{{ style_h3 }}">Parcours de vie</h3>
        {{ pElt.get(evaluation.backgroundPeople) }}
    {% endif %}

    {# Signature #}
    <br/><br/>
    <p style="text-align: right; color: gray;">
        {{ app.user.firstname }} {{ app.user.lastname }}<br/>
        {{ support.service.name }}<br/>
        Association ESPERER 95<br/>
        <i><a href="mailto:{{ app.user.email }}" style="color :blue;">{{ app.user.email }}</a></i><br/> 
        <i>{{ app.user.phone1 }}</i>
    </p>

    {% endapply %}